# CVE-2024-3094 - XZ Utils backdoor

It is possible to inject malicious code into XZ Utils and gain remote access via SSH due to a backdoor discovered by Andres Freund.

## Technical description

Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0. Through a series of complex obfuscations, the liblzma build process extracts a prebuilt object file from a disguised test file existing in the source code, which is then used to modify specific functions in the liblzma code. This results in a modified liblzma library that can be used by any software linked against this library, intercepting and modifying the data interaction with this library.

Source: https://security-tracker.debian.org/tracker/CVE-2024-3094

## At risk

XZ Utils versions 5.6.0 and 5.6.1

### Impacted Linux distributions

* Fedora https://fedoramagazine.org/cve-2024-3094-security-alert-f40-rawhide/
* Debian (unstable) https://security-tracker.debian.org/tracker/CVE-2024-3094

### Not impacted

* Amazon Linux https://aws.amazon.com/security/security-bulletins/AWS-2024-002/

## Mitigation

Fro Debian update to 5.6.1+really5.4.5-1

## Scan and detection

### Manual detection

```
$ xz --version
xz (XZ Utils) 5.6.1
liblzma 5.6.1

```

### Nessus plugins

* 192708 - https://www.tenable.com/cve/CVE-2024-3094/plugins

## Proof of concept

* PoC and a honeypot - https://github.com/amlweems/xzbot
  
## Links

* https://lists.debian.org/debian-security-announce/2024/msg00057.html
* https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils
* https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27
* https://access.redhat.com/security/cve/CVE-2024-3094
* https://aws.amazon.com/security/security-bulletins/AWS-2024-002/
